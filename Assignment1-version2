/*
  space between each block = 400µs
  number of NumPls in a block = 15
  space between each pulse = 1200µs
  Width of signal A's first pulse in a block = 1300µs
  Width addition to sucessive pulses in a block = 50µs
*/


int LEDred = 15; //red LED is connected to pin 15
int LEDgren = 21; //red LED is connected to pin 15
int SW1 = 22; //switch 1 is connected to pin 22
int SW2 = 23; //switch 1 is connected to pin 22

//home
//unsigned long NumPls = 6;
//unsigned long modified = 3;
//unsigned long PlsWdth = 1E6;     //Width of signal A's first pulse is 1 second
//unsigned long PlsGAp = 1E6; // space between each pulse  is 1 second
//unsigned long  extend = 1E6;     //Width addition to sucessive pulses in a block  is 1 second
//unsigned long delai;
//unsigned long BlckSpce = 2E6; //space between each block  is 1 second
//unsigned long grenDly = 5E6; //Sig B's pulse is 5 seconds

//lab
unsigned long NumPls = 15;    //There are 15 pulses in a block
unsigned long modified=12;
unsigned long PlsWdth = 1300;     //Width of signal A's first pulse is 1300µs
unsigned long PlsGAp = 1200; // space between each pulse = 1200µs
unsigned long  extend = 50;     //Width addition to sucessive pulses in a block
unsigned long delai;
unsigned long BlckSpce = 400; //space between each block = 400µs
unsigned long grenDly = 50; //Sig B's pulse is 50μs

void setup()
{
  Serial.begin(9600); //Sets the data rate in bits per second (baud) for serial data transmission
  pinMode(LEDred, OUTPUT); //Configures pin 15 to behave as an output
  pinMode(LEDgren, OUTPUT); //Configures pin 15 to behave as an output
  pinMode(SW1, INPUT); //Configures pin 22 to behave as an input
  pinMode(SW2, INPUT); //Configures pin 23 to behave as an input
}

void loop()
{
  if (HIGH == digitalRead(SW1)) //if switch 1 gets pressed, turn off all LEDs
  {
    Serial.println("Stream disabled"); 
    digitalWrite(LEDred, LOW); //turn off red LED
    digitalWrite(LEDgren, LOW); //turn off green LED
    
  }

  else {
    Serial.println("Stream of pulses is enabled");

    if (HIGH == digitalRead(SW2)) //if switch 2 gets pressed
    {
      NumPls = 12; //Remove 3 pulses from pulse block
      Serial.println("modified waveform cycle");
    }
    else {
      NumPls = 15;
    }

    digitalWrite(LEDgren, HIGH); //LED green is on
    delayMicroseconds(grenDly);
    Serial.println("green on");
    digitalWrite(LEDgren, LOW); //LED green is on

    Serial.println("new block");
    for (int i = 0; i <= (NumPls - 1); i++) //loops NumPls times as there are NumPls pulses in a block. NumPls is determined by mode.
    {
      Serial.print(i);

      //signal A
      digitalWrite(LEDred, HIGH); //LED red is on
      Serial.println(": on");
      delai = PlsWdth + (i * extend); //extend = 0 for the first itteration therefore the length of first pulse is 1300µs
      delayMicroseconds(delai);

      digitalWrite(LEDred, LOW); //LED is off
      delayMicroseconds(PlsGAp); //keep led off for 1200µs
    }

  }
  delayMicroseconds(BlckSpce);//gap between blocks
}
